generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model smart_summary {
  id      Int      @id @default(autoincrement())
  user_id String   @db.Uuid
  date    DateTime @db.Date
  summary String   @db.Text
  users   users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, date])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model breathing_rates {
  id             Int      @id @default(autoincrement())
  user_id        String   @db.Uuid
  date           DateTime @db.Date
  breathing_rate Float
  users          users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, date])
  @@index([user_id, date])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model heart_rate_variabilities {
  id          Int      @id @default(autoincrement())
  user_id     String   @db.Uuid
  date        DateTime @db.Date
  daily_rmssd Float
  deep_rmssd  Float
  users       users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, date])
  @@index([user_id, date])
}

model skin_temperatures {
  id      Int      @id @default(autoincrement())
  user_id String   @db.Uuid
  date    DateTime @db.Date
  average Float
  users   users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, date])
  @@index([user_id, date])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model sleep_logs {
  id          Int      @id @default(autoincrement())
  user_id     String   @db.Uuid
  date        DateTime @db.Date
  bed_time    DateTime @db.Timestamptz(6)
  wake_time   DateTime @db.Timestamptz(6)
  duration_ms BigInt
  efficiency  Int
  awake_mins  Int
  light_mins  Int
  deep_mins   Int
  rem_mins    Int
  users       users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, date])
  @@index([user_id, date])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model spo2_readings {
  id      Int      @id @default(autoincrement())
  user_id String   @db.Uuid
  date    DateTime @db.Date
  avg     Int
  min     Int
  max     Int
  users   users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, date])
  @@index([user_id, date])
}

model users {
  id                       String                     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email                    String?                    @unique
  full_name                String
  display_name             String?
  first_name               String?
  last_name                String?
  avatar_url               String?
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                   @updatedAt @db.Timestamptz(6)
  breathing_rates          breathing_rates[]
  heart_rate_variabilities heart_rate_variabilities[]
  skin_temperatures        skin_temperatures[]
  sleep_logs               sleep_logs[]
  spo2_readings            spo2_readings[]
  smart_summary            smart_summary[]
  fitbitTokens             fitbit_tokens?
}

model fitbit_tokens {
  id             Int      @id @default(autoincrement())
  user_id        String   @unique @db.Uuid
  fitbit_user_id String   @unique
  access_token   String   @db.Text
  refresh_token  String   @db.Text
  expires_at     DateTime @db.Timestamptz(6)
  updated_at     DateTime @updatedAt @db.Timestamptz(6)

  users users @relation(fields: [user_id], references: [id], onDelete: Cascade)
}
